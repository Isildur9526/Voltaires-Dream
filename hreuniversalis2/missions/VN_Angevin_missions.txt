#Angevin missions
#Contributed by Wiz

vn_anj_missions_slot_1_a = {
    slot = 6
    generic = no
    ai = yes
    potential = {
        tag = ANJ
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_anj_breton_marches = {
        icon = mission_conquer_50_development
        required_missions = { vn_anj_seize_le_mans }
        position = 3
        provinces_to_highlight = {
            OR = {
                province_id = 4492
                province_id = 4493
            }
            NOT = { owned_by = ROOT }
        }
        trigger = {
            OR = {
                AND = {
                    owns = 4492
                    4492 = {
                        has_fort_trigger = yes
                    }
                }
                AND = {
                    owns = 4493
                    4493 = {
                        has_fort_trigger = yes
                    }
                }
            }
        }
        effect = {
            add_prestige = 5
            add_mil_power = 50
            nantes_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
        }
    }
    vn_anj_loire_river_valley = {
        icon = mission_advance_to_the_dnieper
        required_missions = { vn_anj_breton_marches }
        provinces_to_highlight = {
            province_id = 2173
            NOT = { 
				owned_by = ROOT
				is_core = ROOT 
			}
        }
        trigger = {
            owns_core_province = 2173
        }
        effect = {
            add_dip_power = 50
            add_country_modifier = {
                name = "anj_loire_river_valley_mission"
                duration = 9125
            }
        }
    }
    vn_anj_atlantic_authority = {
        icon = mission_establish_high_seas_navy
        required_missions = { vn_anj_loire_river_valley }
        trigger = {
            num_of_owned_provinces_with = {
				value = 6
				has_trade_building_trigger = yes
			}
            num_of_owned_provinces_with = {
				value = 6
				OR = {
					has_shipyard_building_trigger = yes
					has_dock_building_trigger = yes
				}
			}
        }
        effect = {
            add_country_modifier = {
                name = "anj_atlantic_authority_mission"
                duration = 9125
            }
        }
    }
}

vn_anj_missions_slot_2_a = {
    slot = 7
    generic = no
    ai = yes
    potential = {
        tag = ANJ
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes
    
    vn_anj_subjugation_of_poitou = {
        icon = mission_conquer_50_development
        required_missions = { vn_anj_greater_anjou }
        position = 4
        provinces_to_highlight = {
            area = poitou_area
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            poitou_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            add_prestige = 10
            poitou_area = {
                limit = { country_or_non_sovereign_subject_holds = ROOT }
                add_province_modifier = {
                    name = "anj_subjugation_of_poitou_mission"
                    duration = 9125
                }
            }
        }
    }
    vn_anj_aquitainian_hegemon = {
        icon = mission_build_up_to_force_limit
        required_missions = { vn_anj_subjugation_of_poitou }
        provinces_to_highlight = {
            region = aquitaine_region
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            aquitaine_region = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            add_prestige = 15
            bordeaux_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            322 = {
                add_province_modifier = {
                    name = "anj_aquitainian_hegemon_mission"
                    duration = 9125
                }
            }
            2003 = {
                add_province_modifier = {
                    name = "anj_aquitainian_hegemon_mission"
                    duration = 9125
                }
            }
        }
    }
    vn_anj_prepare_for_invasion = {
        icon = mission_invade_england
        required_missions = {
            vn_anj_atlantic_authority
            vn_anj_aquitainian_hegemon
            vn_anj_occupy_caen
        }
        trigger = {
            navy_size = 20
            army_size = 25
            if = {
                limit = {
                    has_dlc = "Cradle of Civilization"
                }
                army_professionalism = 0.4
            }
        }
        effect = {
            add_mil_power = 100
            if = {
                limit = {
                    valid_for_personal_unions_trigger = yes
                    exists = ASE
                    ASE = { valid_for_personal_unions_trigger = yes }
                    NOT = { exists = ENG }
                }
                add_casus_belli = {
                    target = ASE
                    type = cb_fabricated_claims
                    months = 300
                }
            }
            else_if = {
                limit = {
                    valid_for_personal_unions_trigger = yes
                    exists = ENG
                    ENG = { valid_for_personal_unions_trigger = yes }
                    NOT = { exists = ASE }
                }
                add_casus_belli = {
                    target = ENG
                    type = cb_fabricated_claims
                    months = 300
                }
            }
        }
    }
    vn_anj_angevin_empire = {
        icon = mission_rb_angevin_kingdom
        required_missions = { vn_anj_prepare_for_invasion }
        provinces_to_highlight = {
            OR = {
                region = southwest_england_region
                region = southeast_england_region
                region = midlands_region
                region = northumbria_region
            }
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            southwest_england_region = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
            southeast_england_region = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
            midlands_region = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
            northumbria_region = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
			if = {
				limit = {
					NOT = { government_rank = 6 }
				}
				set_government_rank = 6
			}
			add_adm_power = 50
			add_dip_power = 50
			add_mil_power = 50
			change_government_reform_progress = 25
            gascony_region = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            brittany_region = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            auvergne_region = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            perigord_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            cahors_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
        }
    }
}

vn_anj_missions_slot_3_a = {
    slot = 8
    generic = no
    ai = yes
    potential = {
        tag = ANJ
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes
    
    vn_anj_control_homelands = {
        icon = mission_monarch_in_throne_room
        required_missions = { }
        position = 1
        provinces_to_highlight = {
            OR = {
				province_id = 2163
				province_id = 1289
				province_id = 2059
				province_id = 4496
				province_id = 4098
			}
            NOT = { 
                owned_by = ROOT
                is_core = ROOT
            }
        }
        trigger = {
			owns_core_province = 2163
			owns_core_province = 1289
			owns_core_province = 2059
			owns_core_province = 4496
			owns_core_province = 4098
            NOT = {
                any_owned_province = {
                    unrest = 1
                }
            }
            stability = 1
            army_size_percentage = 0.75
            legitimacy = 90
        }
        effect = {
			add_stability_or_adm_power = yes
			add_corruption = -2
            maine_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
        }
    }
    vn_anj_seize_le_mans = {
        icon = mission_large_army
        required_missions = { vn_anj_control_homelands }
        provinces_to_highlight = {
            area = maine_area
            NOT = { owned_by = ROOT }
        }
        trigger = {
            maine_area = {
                type = all
                owned_by = ROOT
            }
        }
        effect = {
            add_prestige = 5
            tours_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            alencon_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            4492 = {
				if = {
					limit = {
						NOT = { is_permanent_claim = ROOT }
						NOT = { is_core = ROOT }
					}
					add_permanent_claim = ROOT
				}
			}
            4493 = {
				if = {
					limit = {
						NOT = { is_permanent_claim = ROOT }
						NOT = { is_core = ROOT }
					}
					add_permanent_claim = ROOT
				}
			}
        }
    }
    vn_anj_greater_anjou = {
        icon = mission_rb_angevin_kingdom
        required_missions = { vn_anj_seize_le_mans }
        provinces_to_highlight = {
            OR = {
                area = alencon_area
                region = angevin_region
            }
            NOT = { 
                OR = {
                    AND = {
                        owned_by = ROOT
                        is_core = ROOT
                    }
                    country_or_non_sovereign_subject_holds = ROOT
                }
            }
        }
        trigger = {
            angevin_region = {
                type = all
                owned_by = ROOT
                is_core = ROOT
            }
            alencon_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            add_prestige = 15
            poitou_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            normandy_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            orleans_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
        }
    }
    vn_anj_occupy_caen = {
        icon = mission_village
        required_missions = { vn_anj_greater_anjou }
        position = 5
        provinces_to_highlight = {
            area = normandy_area
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            normandy_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            add_prestige = 10
            caux_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            normandy_area = {
                limit = { country_or_non_sovereign_subject_holds = ROOT }
                add_province_modifier = {
                    name = "anj_occupy_caen_mission"
                    duration = 9125
                }
            }
        }
    }
    vn_anj_advances_in_east = {
        icon = mission_assemble_an_army
        required_missions = { vn_anj_occupy_caen }
        provinces_to_highlight = {
            area = caux_area
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
            caux_area = {
                type = all
                country_or_non_sovereign_subject_holds = ROOT
            }
            num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				value = 5
				area = orleans_area
			}
			4060 = { country_or_non_sovereign_subject_holds = ROOT }
			811 = { country_or_non_sovereign_subject_holds = ROOT }
        }
        effect = {
            add_legitimacy = 10
            paris_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
            4060 = {
                if = {
                    limit = {
						NOT = { has_fort_trigger = yes }
						num_free_building_slots = 1
                    }
                    add_building = fort_14th
                }
            }
            811 = {
                if = {
                    limit = {
						NOT = { has_fort_trigger = yes }
						num_free_building_slots = 1
					}
                    add_building = fort_14th
                }
            }
        }
    }
}

vn_anj_missions_slot_4_a = {
    slot = 9
    generic = no
    ai = yes
    potential = {
        tag = ANJ
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes
    
    vn_anj_end_blesevins = {
        icon = mission_cannons_firing
        required_missions = { vn_anj_greater_anjou }
        position = 4
        provinces_to_highlight = {
            area = orleans_area
            NOT = { 
                owned_by = ROOT
                is_core = ROOT
            }
        }
        trigger = {
            orleans_area = {
                type = all
                owned_by = ROOT
                is_core = ROOT
            }
        }
        effect = {
            add_prestige = 15
            orleans_area = {
                limit = { owned_by = ROOT }
                add_province_modifier = {
                    name = "anj_end_blesevins_mission"
                    duration = 9125
                }
            }
        }
    }
    vn_anj_heirs_of_neustria = {
        icon = mission_empire
        required_missions = { 
            vn_anj_end_blesevins
            vn_anj_advances_in_east
        }
        position = 7
        provinces_to_highlight = {
            OR = {
                region = picard_region
                region = paris_region
            }
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
        }
        trigger = {
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				value = 15
				OR = {
					region = picard_region
					region = paris_region
				}
			}
        }
        effect = {
            add_country_modifier = {
                name = "anj_heirs_of_neustria_mission"
                duration = 9125
            }
        }
    }
}

vn_anj_missions_slot_5_a = {
    slot = 10
    generic = no
    ai = yes
    potential = {
        tag = ANJ
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes
    
    vn_anj_angevin_castlebuilding = {
        icon = mission_european_castle
        required_missions = { }
        position = 1
        trigger = {
			num_of_owned_provinces_with = {
				value = 5
				has_fort_trigger = yes
			}
        }
        effect = {
			add_yearly_manpower = 0.5
            add_country_modifier = {
                name = "anj_angevin_castlebuilding_mission"
                duration = 9125
            }
        }
    }
    vn_anj_black_city = {
        icon = mission_big_city
        required_missions = { vn_anj_angevin_castlebuilding }
        provinces_to_highlight = {
            province_id = 1289
        }
        trigger = {
            1289 = {
                owned_by = ROOT
                development = 20
                has_fort_trigger = yes
                has_trade_building_trigger = yes
            }
        }
        effect = {
            1289 = {
                add_base_tax = 3
                add_province_modifier = {
                    name = "anj_black_city_mission"
                    duration = 9125
                }
            }
        }
    }
    vn_anj_erode_baronial_power = {
        icon = mission_have_two_subjects
        required_missions = { vn_anj_black_city }
        trigger = {
            estate_loyalty = {
                estate = estate_nobles
                loyalty = 60
            }
            estate_loyalty = {
                estate = estate_church
                loyalty = 60
            }
            estate_loyalty = {
                estate = estate_burghers
                loyalty = 60
            }
            NOT = {
                estate_influence = {
                    estate = estate_nobles
                    influence = 40
				}
			}
			NOT = {
                estate_influence = {
                    estate = estate_church
                    influence = 40
				}
			}
			NOT = {
                estate_influence = {
                    estate = estate_burghers
                    influence = 40
                }
            }
        }
        effect = {
            add_country_modifier = {
                name = "anj_erode_baronial_power_mission"
                duration = 9125
            }
        }
    }
    vn_anj_centralize_realm = {
        icon = mission_noble_council
        required_missions = { vn_anj_erode_baronial_power }
        trigger = {
            if = {
                limit = { has_dlc = "Mandate of Heaven" }
                absolutism = 50
            }
            NOT = { average_unrest = 1 }
        }
        effect = {
            add_legitimacy = 10
            add_country_modifier = {
                name = "anj_centralize_realm_mission"
                duration = 9125
            }
        }
    }
}

vn_anj_missions_slot_5_b = {
    slot = 10
    generic = no
    ai = yes
    potential = {
        tag = ANJ
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes
    
    vn_anj_honor_our_crusaders = {
        icon = mission_crusade
        required_missions = { }
        position = 5
        provinces_to_highlight = {
            OR = {
                province_id = 1289
                province_id = 2489
                province_id = 2177
            }
        }
        trigger = {
            1289 = {
				owned_by = ROOT
                has_tax_building_trigger = yes
            }
            2489 = {
				owned_by = ROOT
                has_tax_building_trigger = yes
            }
            2177 = {
				owned_by = ROOT
                has_tax_building_trigger = yes
            }
            if = {
                limit = { has_estate = estate_church }
                estate_territory = {
                    estate = estate_church
                    territory = 15
                }
            }
        }
        effect = {
            add_country_modifier = {
                name = "anj_honor_our_crusaders_mission"
                duration = 9125
            }
        }
    }
    vn_anj_loyalty_to_rome = {
        icon = mission_hands_praying
        required_missions = { vn_anj_honor_our_crusaders }
        trigger = {
            is_year = 1600
            religion = catholic
            OR = {
                papal_influence = 100
                is_papal_controller = yes
            }
            NOT = {
                any_owned_province = {
                    is_in_capital_area = yes
                    NOT = { religion = catholic }
                }
            }
        }
        effect = {
            add_country_modifier = {
                name = "anj_loyalty_to_rome_mission"
                duration = 9125
            }
        }
    }
}