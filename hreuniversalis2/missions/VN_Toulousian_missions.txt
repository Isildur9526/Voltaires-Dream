#Toulousian missions
#By ShyGuy13

vn_tou_missions_slot_1 = {
	slot = 6
	generic = no
	ai = yes
	
	potential = {
		tag = TOU
		NOT = { map_setup = map_setup_random }
	}
	has_country_shield = yes
	
	vn_tou_weather_catharism = {
		position = 1
		icon = mission_rb_control_state_religion
		required_missions = {}
		trigger = {
			religion_years = { cathar = 10 }
			any_owned_province = {
				religion = cathar
			}
		}
		effect = {
			if = {
				limit = { NOT = { religion = cathar } }
				country_event = { id = vn_missions.24 }
			}
			else = {
				add_prestige = 25
			}
		}
	}
	vn_tou_secure_religious_peace = {
		icon = mission_religious
		required_missions = { vn_tou_weather_catharism }
		trigger = {
			custom_trigger_tooltip = {
				tooltip = vn_tou_secure_religious_peace.tt
				had_country_flag = {
					flag = tou_cathar_heresy
					days = 10950
				}
			}
			religious_unity = 1
			OR = {
				inquisitor = 3
				theologian = 3
			}
		}
		effect = {
			add_stability_or_adm_power = yes
			add_country_modifier = {
				name = "tou_secure_religious_peace_mission"
				duration = -1
			}
		}
	}
	vn_tou_crusading_army = {
		position = 4
		icon = mission_teutonic_knights
		required_missions = { }
		trigger = {
			if = {
				limit = {
					OR = {
						has_estate = estate_holy_orders
						current_age = age_of_empire
					}
				}
				estate_loyalty = {
					estate = estate_holy_orders
					loyalty = 65
				}
			}
			army_size = 25
			num_of_cavalry = 10
			num_of_generals = 2
		}
		effect = {
			define_advisor = {
				type = army_organiser
				name = "Pierre Barthélemy"
				religion = catholic
				culture = occitain
				skill = 3
				cost_multiplier = 0.25
			}
			3027 = { 
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
			}
			add_country_modifier = {
				name = tou_crusading_army_mission
				duration = 9125
			}
		}
	}
	vn_tou_seize_tripoli = {
		icon = mission_crusade
		required_missions = { vn_tou_crusading_army }
		provinces_to_highlight = {
			province_id = 3027
		}
		trigger = {
			3027 = { country_or_non_sovereign_subject_holds = ROOT }
		}
		effect = {
			add_prestige = 15
			add_religious_influence_effect_small = yes
			lebanon_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			tartus_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
		}
	}
	vn_tou_fortify_tripoli = {
		icon = mission_conquer_50_development
		required_missions = { vn_tou_seize_tripoli }
		provinces_to_highlight = {
			province_id = 3027
		}
		trigger = {
			3027 = {
				owned_by = ROOT
				has_fort_trigger = yes
				NOT = { devastation = 1 }
				NOT = { unrest = 1 }
			}
		}
		effect = {
			3027 = {
				add_base_manpower = 3
				add_province_modifier = {
					name = tou_fortify_tripoli_mission
					duration = -1
				}
			}
		}
	}
}

vn_tou_missions_slot_2 = {
	slot = 7
	generic = no
	ai = yes
	
	potential = {
		tag = TOU
		NOT = { map_setup = map_setup_random }
	}
	has_country_shield = yes
	
	vn_tou_aquitaine_rivalry = {
		position = 1
		icon = mission_humiliate_provence
		required_missions = {}
		trigger = {
			army_size_percentage = 0.95
			any_rival_country = {
				primary_culture = poitevin
			}
		}
		effect = {
			add_dip_power = 50
			armagnac_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			cahors_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
		}
	}
	vn_tou_conquer_foix = {
		position = 2
		icon = mission_soldiers_in_line
		required_missions = { vn_tou_aquitaine_rivalry }
		provinces_to_highlight = {
			area = armagnac_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		trigger = {
			armagnac_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		effect = {
			bearn_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			labourd_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
		}
	}
	vn_tou_conquer_bearn = {
		icon = mission_unite_home_region
		required_missions = { vn_tou_conquer_foix }
		provinces_to_highlight = {
			OR = {
				area = bearn_area
				area = labourd_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		trigger = {
			bearn_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			labourd_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		effect = {
			add_mil_power = 100
			bordeaux_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
		}
	}
	vn_tou_conquer_bordeaux = {
		icon = mission_unite_coromandel
		required_missions = { vn_tou_conquer_bearn }
		provinces_to_highlight = {
			area = bordeaux_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		trigger = {
			bordeaux_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		effect = {
			angouleme_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			poitou_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
		}
	}
	vn_tou_conquer_aquitaine = {
		icon = mission_have_two_subjects
		required_missions = { vn_tou_conquer_bordeaux }
		provinces_to_highlight = {
			OR = {
				area = angouleme_area
				area = poitou_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		trigger = {
			angouleme_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			poitou_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		effect = {
			add_prestige = 10
			2324 = {
				add_trade_modifier = {
                    who = ROOT
                    duration = 9125
                    power = 10
                    key = tou_conquer_aquitaine_mission
                }
			}
		}
	}
	vn_tou_conquer_holy_land = {
		icon = mission_arabian_fort
		required_missions = { vn_tou_seize_tripoli }
		provinces_to_highlight = {
			OR = {
				area = lebanon_area
				area = tartus_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		trigger = {
			lebanon_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			tartus_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		effect = {
			add_army_tradition = 20
			add_country_modifier = {
				name = tou_conquer_holy_land
				duration = 9125
			}
		}
	}
}

vn_tou_missions_slot_3 = {
	slot = 8
	generic = no
	ai = yes
	
	potential = {
		tag = TOU
		NOT = { map_setup = map_setup_random }
	}
	has_country_shield = yes
	
	vn_tou_conquer_rouergue = {
		position = 2
		icon = mission_consolidate_the_state
		required_missions = { vn_tou_aquitaine_rivalry }
		provinces_to_highlight = {
			area = cahors_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		trigger = {
			cahors_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		effect = {
			perigord_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			limousin_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
		}
	}
	vn_tou_conquer_limoges = {
		position = 5
		icon = mission_secure_khandesh
		required_missions = { vn_tou_conquer_rouergue vn_tou_conquer_bordeaux }
		provinces_to_highlight = {
			OR = {
				area = perigord_area
				area = limousin_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		trigger = {
			perigord_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			limousin_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		effect = {
			add_country_modifier = {
				name = "tou_conquer_limoges_mission"
				duration = 9125
			}
		}
	}
	vn_tou_elevation_to_principality = {
		icon = mission_invade_occitania
		required_missions = { vn_tou_conquer_aquitaine vn_tou_conquer_limoges vn_tou_conquer_provence }
		trigger = {
			is_subject = no
			stability = 1
			total_development = 200
		}
		effect = {
			country_event = { id = vn_missions.23 }
			french_superregion = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
		}
	}
}

vn_tou_missions_slot_4 = {
	slot = 9
	generic = no
	ai = yes
	
	potential = {
		tag = TOU
		NOT = { map_setup = map_setup_random }
	}
	has_country_shield = yes

	vn_tou_aragonese_rivalry = {
		position = 1
		icon = mission_intervene_in_castile
		required_missions = { }
		trigger = {
			if = {
				limit = {
					exists = ARA
					ARA = { is_free_or_tributary_trigger = yes }
				}
				AND = {
					is_rival = ARA
					ARA = {
						OR = {
							has_opinion_modifier = {
								who = ROOT
								modifier = insulted
							}
							has_opinion_modifier = {
								who = ROOT
								modifier = scornfully_insulted
							}
						}
					}
				}
			}
			else = {
				num_of_allies = 4
			}
		}
		effect = {
			narbonne_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			toulouse_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			add_country_modifier = {
				name = tou_aragonese_rivalry_mission
				duration = 9125
			}
		}
	}
	vn_tou_conquer_carcassonne = {
		position = 3
		icon = mission_junnagadh_fort
		required_missions = { vn_tou_aragonese_rivalry }
		provinces_to_highlight = {
			OR = {
				area = narbonne_area
				area = toulouse_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		trigger = {
			narbonne_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			toulouse_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		effect = {
			montpellier_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			viviers_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
		}
	}
	vn_tou_conquer_languedoc = {
		position = 4
		icon = mission_secure_hajj_ports
		required_missions = { vn_tou_conquer_carcassonne }
		provinces_to_highlight = {
			OR = {
				area = montpellier_area
				area = viviers_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		trigger = {
			montpellier_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			viviers_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		effect = {
			provence_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
			narbonne_area = {
				limit = { country_or_non_sovereign_subject_holds = ROOT }
				add_province_modifier = {
					name = "tou_conquer_languedoc_mission"
					duration = 9125
				}
			}
			montpellier_area = {
				limit = { country_or_non_sovereign_subject_holds = ROOT }
				add_province_modifier = {
					name = "tou_conquer_languedoc_mission"
					duration = 9125
				}
			}
		}
	}
	vn_tou_conquer_provence = {
		position = 5
		icon = mission_unite_home_region
		required_missions = { vn_tou_conquer_languedoc }
		provinces_to_highlight = {
			region = provence_region
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		trigger = {
			provence_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		effect = {
			add_country_modifier = {
				name = "tou_conquer_provence_mission"
				duration = 9125
			}
		}
	}
}

vn_tou_missions_slot_5 = {
	slot = 10
	generic = no
	ai = yes
	
	potential = {
		tag = TOU
		NOT = { map_setup = map_setup_random }
	}
	has_country_shield = yes
	
	vn_tou_challenge_the_king = {
		position = 1
		icon = mission_the_french_menace
		required_missions = { }
		trigger = {
			land_forcelimit = 25
			if = {
				limit = { exists = FRA }
				total_development = FRA
			}
			else = {
				total_development = 200
			}
		}
		effect = {
			add_prestige = 15
			add_manpower = 5
			add_country_modifier = {
				name = "tou_challenge_the_king_mission"
				duration = 9125
			}
		}
	}
	vn_tou_occitan_kingdom = {
		icon = mission_coronation
		required_missions = { vn_tou_challenge_the_king }
		provinces_to_highlight = {
			superregion = french_superregion
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
		trigger = {
			french_superregion = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}
		effect = {
			add_prestige = 25
			add_country_modifier = {
				name = tou_occitan_kingdom_mission
				duration = 9125
			}
		}
	}
	vn_tou_occitan_wine_empire = {
		position = 4
		icon = mission_wine_monopolies
		required_missions = { vn_tou_conquer_carcassonne }
		trigger = {
			wine = 10
			trading_bonus = {
				trade_goods = wine
				value = yes
			}
			num_of_owned_provinces_with = {
				value = 3
				trade_goods = wine
				has_production_building_trigger = yes
			}
		}
		effect = {
			add_mercantilism = 2
			add_country_modifier = {
				name = "tou_occitan_wine_empire_mission"
				duration = 9125
			}
		}
	}
	vn_tou_ports_of_languedoc = {
		position = 5
		icon = mission_naval_expansion
		required_missions = { vn_tou_conquer_languedoc }
		provinces_to_highlight = {
			region = toulouse_region
			has_port = yes
			OR = {
				has_dock_building_trigger = no
				has_shipyard_building_trigger = no
			}
		}
		trigger = {
			num_of_owned_provinces_with = {
				value = 5
				region = toulouse_region
				has_dock_building_trigger = yes
				has_shipyard_building_trigger = yes
			}
		}
		effect = {
			add_navy_tradition = 10
			balears_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_claim = ROOT }
				}
				add_claim = ROOT
			}
			toulouse_region = {
				limit = {
					has_port = yes
					owned_by = ROOT
				}
				add_province_modifier = {
					name = tou_ports_of_languedoc_mission
					duration = 9125
				}
			}
		}
	}
}