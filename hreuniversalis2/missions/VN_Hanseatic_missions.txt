#Hanseatic Missions
#by ShyGuy13

vn_hsa_missions_slot_1 = {
    slot = 6
    generic = no
    ai = yes
    potential = {
		OR = {
            tag = HSA
            tag = CYB
            tag = HAM
            tag = DNZ
            tag = RGS
        }
		NOT = { map_setup = map_setup_random }
	}
    has_country_shield = yes

    vn_hsa_empower_the_hansa = {
        position = 2
        icon = mission_grand_bengali_shipyards
        required_missions = { vn_hsa_convene_the_hansetag }
        trigger = {
            total_development = 250
            trade_income_percentage = 0.4
            NOT = {
                any_rival_country = {
                    monthly_income = ROOT
                }
            }
        }
        effect = {
            add_country_modifier = {
                name = hsa_empower_the_hansa_mission
                duration = 9125
            }
        }
    }
    vn_hsa_conquer_london = {
        position = 4
        icon = mission_grand_bengali_shipyards
        required_missions = { vn_hsa_improve_navigation }
        provinces_to_highlight = {
            OR = {
                province_id = 2268
                province_id = 2004
                province_id = 2107
            }
            OR = {
                NOT = { owned_by = ROOT }
                NOT = { is_core = ROOT }
                NOT = {
                    owner = {
                        is_in_trade_league_with = ROOT
                    }
                }
            }
        }
        trigger = {
            OR = {
                owns_core_province = 2268
                AND = {
                    is_trade_league_leader = yes
                    2268 = {
                        owner = {
                            is_in_trade_league_with = ROOT
                        }
                    }
                }
            }
            OR = {
                owns_core_province = 2004
                AND = {
                    is_trade_league_leader = yes
                    2004 = {
                        owner = {
                            is_in_trade_league_with = ROOT
                        }
                    }
                }
            }
            OR = {
                owns_core_province = 2107
                AND = {
                    is_trade_league_leader = yes
                    2107 = {
                        owner = {
                            is_in_trade_league_with = ROOT
                        }
                    }
                }
            }
        }
        effect = {
            define_advisor = {
                type = trader
                skill = 3
                cost_multiplier = 0.25
                culture = english
            }
            2268 = {
                add_base_tax = 1
                add_base_production = 1
                add_province_modifier = {
                    name = hsa_conquer_london_mission
                    duration = 9125
                }
            }
            2004 = {
                add_base_tax = 1
                add_base_production = 1
                add_province_modifier = {
                    name = hsa_conquer_london_mission
                    duration = 9125
                }
            }
            2107 = {
                add_base_tax = 1
                add_base_production = 1
                add_province_modifier = {
                    name = hsa_conquer_london_mission
                    duration = 9125
                }
            }
        }
    }
}

vn_hsa_missions_slot_2 = {
    slot = 7
    generic = no
    ai = yes
    potential = {
		OR = {
            tag = HSA
            tag = CYB
            tag = HAM
            tag = DNZ
            tag = RGS
        }
		NOT = { map_setup = map_setup_random }
	}
    has_country_shield = yes

    vn_hsa_convene_the_hansetag = {
        position = 1
        icon = mission_hanseatic_city
        required_missions = { }
        trigger = {
			if = {
                limit = { has_dlc = "Mare Nostrum" }
                OR = {
                    AND = {
                        is_trade_league_leader = yes
                        calc_true_if = {
                            amount = 5
                            all_country = {
                                is_in_trade_league = ROOT
                                has_opinion = {
                                    who = ROOT
                                    value = 150
                                }
                            }
                        }
                    }
                    AND = {
                        num_of_allies = 5
                        trade_income_percentage = 0.5
                    }
                }
            }
            else = {
                num_of_allies = 5
                trade_income_percentage = 0.5
            }
        }
        effect = {
            add_dip_power = 25
            add_country_modifier = {
                name = hsa_convene_the_hansetag_mission
                duration = 9125
            }
        }
    }
    vn_hsa_war_fleet = {
        icon = mission_launch_a_flagship
        required_missions = { vn_hsa_convene_the_hansetag }
        trigger = {
            navy_size = 20
            navy_size_percentage = 0.75
            num_of_admirals = 2
        }
        effect = {
            add_country_modifier = {
                name = hsa_war_fleet_mission
                duration = 9125
            }
        }
    }
    vn_hsa_improve_navigation = {
        icon = mission_launch_a_flagship
        required_missions = { vn_hsa_war_fleet }
        trigger = {
            navy_tradition = 50
            navy_size = 40
			if = {
                limit = {
                    has_dlc = "Golden Century"
                }
                has_flagship = yes
            }
        }
        effect = {
            add_innovativeness_small_effect = yes
            2268 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
            }
            2004 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
            }
            2107 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
            }
            328 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
            }
            327 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
            }
            896 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
            }
            142 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
            }
            2729 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
			}
            add_country_modifier = {
                name = hsa_improve_navigation_mission
                duration = 9125
            }
        }
    }
    vn_hsa_conquer_amsterdam = {
        position = 4
        icon = mission_corsairs_of_the_north_sea
        required_missions = { vn_hsa_improve_navigation }
        provinces_to_highlight = {
            OR = {
                province_id = 328
                province_id = 327
                province_id = 896
                province_id = 142
                province_id = 2729
            }
            OR = {
                NOT = { owned_by = ROOT }
                NOT = { is_core = ROOT }
                NOT = {
                    owner = {
                        is_in_trade_league_with = ROOT
                    }
                }
            }
        }
        trigger = {
            calc_true_if = {
                amount = 3
                OR = {
                    owns_core_province = 328
                    AND = {
                        is_trade_league_leader = yes
                        328 = {
                            owner = {
                                is_in_trade_league_with = ROOT
                            }
                        }
                    }
                }
                OR = {
                    owns_core_province = 327
                    AND = {
                        is_trade_league_leader = yes
                        327 = {
                            owner = {
                                is_in_trade_league_with = ROOT
                            }
                        }
                    }
                }
                OR = {
                    owns_core_province = 896
                    AND = {
                        is_trade_league_leader = yes
                        896 = {
                            owner = {
                                is_in_trade_league_with = ROOT
                            }
                        }
                    }
                }
                OR = {
                    owns_core_province = 142
                    AND = {
                        is_trade_league_leader = yes
                        142 = {
                            owner = {
                                is_in_trade_league_with = ROOT
                            }
                        }
                    }
                }
                OR = {
                    owns_core_province = 2729
                    AND = {
                        is_trade_league_leader = yes
                        2729 = {
                            owner = {
                                is_in_trade_league_with = ROOT
                            }
                        }
                    }
                }
            }
        }
        effect = {
           add_country_modifier = {
               name = hsa_conquer_amsterdam_mission
               duration = 9125
           }
        }
    }
    vn_hsa_channel_trade = {
        icon = mission_entrepot_of_india
        required_missions = { vn_hsa_conquer_amsterdam vn_hsa_conquer_london }
        provinces_to_highlight = {
            OR = {
                province_id = 2729
                province_id = 328
                province_id = 1084
                province_id = 6038
                province_id = 2268
            }
            NOT = { is_strongest_trade_power = ROOT }
        }
        trigger = {
			2729 = {
                is_strongest_trade_power = ROOT
            }
            328 = {
                is_strongest_trade_power = ROOT
            }
            1084 = {
                is_strongest_trade_power = ROOT
            }
            6038 = {
                is_strongest_trade_power = ROOT
            }
            2268 = {
                is_strongest_trade_power = ROOT
            }
        }
        effect = {
            add_navy_tradition = 25
            add_prestige = 25
        }
    }
}

vn_hsa_missions_slot_3 = {
    slot = 8
    generic = no
    ai = yes
    potential = {
		OR = {
            tag = HSA
            tag = CYB
            tag = HAM
            tag = DNZ
            tag = RGS
        }
		NOT = { map_setup = map_setup_random }
	}
    has_country_shield = yes

    vn_hsa_merchant_cogs = {
        position = 1
        icon = mission_unite_coromandel
        required_missions = { }
        trigger = {
            navy_size_percentage = 1
            light_ship_fraction = 0.4
        }
        effect = {
            411 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
            }
            2697 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
            }
            6131 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
			}
            6130 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
			}
            add_country_modifier = {
                name = hsa_merchant_cogs_mission
                duration = 9125
            }
        }
    }
    vn_hsa_end_sound_toll = {
        position = 2
        icon = mission_unite_coromandel
        required_missions = { vn_hsa_merchant_cogs vn_hsa_convene_the_hansetag }
        provinces_to_highlight = {
            province_id = 411
        }
        trigger = {
            OR = {
                owns_core_province = 411
                AND = {
                    is_trade_league_leader = yes
                    411 = {
                        owner = {
                            is_in_trade_league_with = ROOT
                        }
                    }
                }
                411 = {
                    owner = {
                        alliance_with = ROOT
                        has_opinion = {
                            who = ROOT
                            value = 150
                        }  
                    }
                }
                411 = {
                    owner = {
                        war_with = ROOT
                        NOT = {
                            war_score_against = {
                                who = ROOT
                                value = -75
                            }
                        }  
                    }
                }
            }
        }
        effect = {
            6038 = {
                if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}
            }
            6001 = {
                if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}
            }
            6070 = {
                if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}
            }
            656 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
			}
            6109 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
			}
            add_country_modifier = {
                name = hsa_merchant_cogs_mission
                duration = 9125
            }
        }
    }
    vn_hsa_scandinavian_trade_colonies = {
        icon = mission_advance_to_the_dnieper
        required_missions = { vn_hsa_end_sound_toll }
        provinces_to_highlight = {
            OR = {
                province_id = 6038
                province_id = 6001
                province_id = 6070
                province_id = 656
                province_id = 6109
            }
            OR = {
                NOT = { owned_by = ROOT }
                NOT = { is_core = ROOT }
                NOT = {
                    owner = {
                        is_in_trade_league_with = ROOT
                    }
                }
            }
        }
        trigger = {
            calc_true_if = {
                amount = 3
                OR = {
                    owns_core_province = 6038
                    AND = {
                        is_trade_league_leader = yes
                        6038 = {
                            owner = {
                                is_in_trade_league_with = ROOT
                            }
                        }
                    }
                }
                OR = {
                    owns_core_province = 6001
                    AND = {
                        is_trade_league_leader = yes
                        6001 = {
                            owner = {
                                is_in_trade_league_with = ROOT
                            }
                        }
                    }
                }
                OR = {
                    owns_core_province = 6070
                    AND = {
                        is_trade_league_leader = yes
                        6070 = {
                            owner = {
                                is_in_trade_league_with = ROOT
                            }
                        }
                    }
                }
                OR = {
                    owns_core_province = 656
                    AND = {
                        is_trade_league_leader = yes
                        656 = {
                            owner = {
                                is_in_trade_league_with = ROOT
                            }
                        }
                    }
                }
                OR = {
                    owns_core_province = 6109
                    AND = {
                        is_trade_league_leader = yes
                        6109 = {
                            owner = {
                                is_in_trade_league_with = ROOT
                            }
                        }
                    }
                }
            }
        }
        effect = {
            add_years_of_income = 2.5
            add_mercantilism = 5
        }
    }
}

vn_hsa_missions_slot_4 = {
    slot = 9
    generic = no
    ai = yes
    potential = {
		OR = {
            tag = HSA
            tag = CYB
            tag = HAM
            tag = DNZ
            tag = RGS
        }
		NOT = { map_setup = map_setup_random }
	}
    has_country_shield = yes

    vn_hsa_conquer_gotland = {
        position = 2
        icon = mission_corsairs_of_the_north_sea
        required_missions = { vn_hsa_merchant_cogs }
        provinces_to_highlight = {
            OR = {
                province_id = 2697
                province_id = 6131
                province_id = 6130
            }
            OR = {
                NOT = { owned_by = ROOT }
                NOT = { is_core = ROOT }
                NOT = {
                    owner = {
                        is_in_trade_league_with = ROOT
                    }
                }
            }
        }
        trigger = {
            OR = {
                owns_core_province = 2697
                AND = {
                    is_trade_league_leader = yes
                    2697 = {
                        owner = {
                            is_in_trade_league_with = ROOT
                        }
                    }
                }
            }
            OR = {
                owns_core_province = 6131
                AND = {
                    is_trade_league_leader = yes
                    6131 = {
                        owner = {
                            is_in_trade_league_with = ROOT
                        }
                    }
                }
            }
            OR = {
                owns_core_province = 6130
                AND = {
                    is_trade_league_leader = yes
                    6130 = {
                        owner = {
                            is_in_trade_league_with = ROOT
                        }
                    }
                }
            }
        }
        effect = {
            add_navy_tradition = 10
            2697 = {
                add_base_tax = 1
            }
            6131 = {
                add_base_tax = 1
            }
            6130 = {
                add_base_tax = 1
            }
            3427 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
			}
        }
    }
    vn_hsa_conquer_novgorod = {
        position = 3
        icon = mission_corsairs_of_the_north_sea
        required_missions = { vn_hsa_conquer_gotland }
        provinces_to_highlight = {
            province_id = 3427
        }
        trigger = {
            OR = {
                owns_core_province = 3427
                AND = {
                    is_trade_league_leader = yes
                    3427 = {
                        owner = {
                            is_in_trade_league_with = ROOT
                        }
                    }
                }
            }
        }
        effect = {
            3427 = {
                add_trade_modifier = {
                    who = ROOT
                    duration = 9125
                    power = 15
                    key = hsa_conquer_novgorod_mission
                }
            }
        }
    }
    vn_hsa_baltic_hegemon = {
        position = 4
        icon = mission_claim_the_canaries
        required_missions = { vn_hsa_scandinavian_trade_colonies vn_hsa_conquer_novgorod }
        provinces_to_highlight = {
            OR = {
                province_id = 13
                province_id = 402
                province_id = 5793
                province_id = 3427
                province_id = 2697
            }
            NOT = { is_strongest_trade_power = ROOT }
        }
        trigger = {
            13 = {
                is_strongest_trade_power = ROOT
            }
            402 = {
                is_strongest_trade_power = ROOT
            }
            5793 = {
                is_strongest_trade_power = ROOT
            }
            3427 = {
                is_strongest_trade_power = ROOT
            }
            2697 = {
                is_strongest_trade_power = ROOT
            }
        }
        effect = {
            add_prestige = 15
            1084 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
            }
            13 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
            }
            402 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
            }
            5793 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
            }
            429 = {
				if = {
					limit = {
						NOT = { is_core = ROOT }
						NOT = { is_permanent_claim = ROOT }
					}
					add_permanent_claim = ROOT	
				}		
            }
            add_country_modifier = {
                name = hsa_baltic_hegemon_mission
                duration = 18250
            }
        }
    }
    vn_hsa_unite_the_hansa = {
        position = 5
        icon = mission_claim_the_canaries
        required_missions = { vn_hsa_baltic_hegemon vn_hsa_commercial_revolution }
        provinces_to_highlight = {
            OR = {
                province_id = 1084
                province_id = 13
                province_id = 402
                province_id = 5793
                province_id = 429
            }
            OR = {
                NOT = { owned_by = ROOT }
                NOT = { is_core = ROOT }
                NOT = {
                    owner = {
                        is_in_trade_league_with = ROOT
                    }
                }
            }
        }
        trigger = {
            OR = {
                owns_core_province = 1084
                AND = {
                    is_trade_league_leader = yes
                    1084 = {
                        owner = {
                            is_in_trade_league_with = ROOT
                        }
                    }
                }
            }
            OR = {
                owns_core_province = 13
                AND = {
                    is_trade_league_leader = yes
                    13 = {
                        owner = {
                            is_in_trade_league_with = ROOT
                        }
                    }
                }
            }
            OR = {
                owns_core_province = 402
                AND = {
                    is_trade_league_leader = yes
                    402 = {
                        owner = {
                            is_in_trade_league_with = ROOT
                        }
                    }
                }
            }
            OR = {
                owns_core_province = 5793
                AND = {
                    is_trade_league_leader = yes
                    5793 = {
                        owner = {
                            is_in_trade_league_with = ROOT
                        }
                    }
                }
            }
            OR = {
                owns_core_province = 429
                AND = {
                    is_trade_league_leader = yes
                    429 = {
                        owner = {
                            is_in_trade_league_with = ROOT
                        }
                    }
                }
            }
        }
        effect = {
            #form the Hanseatic League
            #every_country = {
            #    limit = { is_in_trade_league = ROOT }
            #    ROOT = {
            #        vassalize = PREV
            #    }
            #}
        }
    }
}

vn_hsa_missions_slot_5 = {
    slot = 10
    generic = no
    ai = yes
    potential = {
		OR = {
            tag = HSA
            tag = CYB
            tag = HAM
            tag = DNZ
            tag = RGS
        }
		NOT = { map_setup = map_setup_random }
	}
    has_country_shield = yes

    vn_hsa_city_of_wealth_and_glory = {
        position = 1
        icon = mission_dominate_genoa
        required_missions = { }
        provinces_to_highlight = {
            is_capital_of = ROOT
        }
        trigger = {
			capital_scope = {
                num_of_times_improved = 10
                calc_true_if = {
                    amount = 3
                    has_trade_building_trigger = yes
                    has_production_building_trigger = yes
                    has_tax_building_trigger = yes
                    has_medical_building_trigger = yes
                    has_education_building_trigger = yes
                }
            }
        }
        effect = {
            capital_scope = {
                if = {
                    limit = {
                        NOT = { province_has_center_of_trade_of_level = 1 }
                    }
                    add_center_of_trade_level = 1
                }
                add_province_modifier = {
                    name = hsa_city_of_wealth_and_glory_mission
                    duration = 9125
                }
            }
        }
    }
    vn_hsa_productive_powerhouse = {
        position = 3
        icon = mission_disrupt_portuguese_trade
        required_missions = { vn_hsa_city_of_wealth_and_glory }
        trigger = {
            monthly_income = 25
        }
        effect = {
            add_prestige = 15
            add_inflation = -1
        }
    }
    vn_hsa_commercial_revolution = {
        position = 4
        icon = mission_disrupt_portuguese_trade
        required_missions = { vn_hsa_productive_powerhouse }
        trigger = {
            treasury = 2000
            NOT = { inflation = 1 }
            NOT = { num_of_loans = 1 }
        }
        effect = {
            add_country_modifier = {
                name = hsa_commercial_revolution
                duration = 9125
            }
        }
    }
}