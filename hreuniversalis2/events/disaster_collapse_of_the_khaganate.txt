namespace = collapse_of_the_khaganate

country_event = {
	id = collapse_of_the_khaganate.1
	title = collapse_of_the_khaganate.1.t
	desc = collapse_of_the_khaganate.1.d
	picture = {
		trigger = { NOT = { has_dlc = "Star and Crescent" } }
		picture = COUNTRY_COLLAPSE_eventPicture
	}
	picture = {
		trigger = { has_dlc = "Star and Crescent" }
		picture = muslimgfx_COUNTRY_COLLAPSE_eventPicture
	}

	is_triggered_only = yes
	major = yes

	immediate = {
		hidden_effect = {
			set_country_flag = had_collapse_of_the_khaganate
			if = {
				limit = { tag = GLH }
				#Great Horde
				lower_don_region = {
					limit = { owned_by = ROOT }
					add_core = GOL
					if = {
						limit = {
							OR = {
								culture = pecheneg
								culture = cuman
							}
						}
						change_culture = mishary
					}
				}
				khopyor_region = {
					limit = { owned_by = ROOT }
					add_core = GOL
					if = {
						limit = {
							OR = {
								culture = pecheneg
								culture = cuman
							}
						}
						change_culture = mishary
					}
				}
				sloboda_region = {
					limit = { owned_by = ROOT }
					add_core = GOL
					if = {
						limit = {
							OR = {
								culture = pecheneg
								culture = cuman
							}
						}
						change_culture = mishary
					}
				}
				#Crimea
				azov_region = {
					limit = { owned_by = ROOT }
					add_core = CRI
					if = {
						limit = {
							OR = {
								culture = pecheneg
								culture = cuman
							}
						}
						change_culture = crimean
					}
				}
				crimea_region = {
					limit = { owned_by = ROOT }
					add_core = CRI
					if = {
						limit = {
							OR = {
								culture = pecheneg
								culture = cuman
							}
						}
						change_culture = crimean
					}
				}
				wild_fields_region = {
					limit = { owned_by = ROOT }
					add_core = CRI
					if = {
						limit = {
							OR = {
								culture = pecheneg
								culture = cuman
							}
						}
						change_culture = crimean
					}
				}
				#Kazan
				kazan_region = {
					limit = { owned_by = ROOT }
					add_core = KAZ
					if = {
						limit = {
							OR = {
								culture = pecheneg
								culture = cuman
							}
						}
						change_culture = kazani
					}
				}
				mordovia_region = {
					limit = { owned_by = ROOT }
					add_core = KAZ
					if = {
						limit = {
							OR = {
								culture = pecheneg
								culture = cuman
							}
						}
						change_culture = kazani
					}
				}
				#Nogai
				bashkiria_region = {
					limit = { owned_by = ROOT }
					add_core = NOG
					if = {
						limit = {
							OR = {
								culture = pecheneg
								culture = cuman
							}
						}
						change_culture = nogaybak
					}
				}
				atyrau_area = {
					limit = { owned_by = ROOT }
					add_core = NOG
					if = {
						limit = {
							OR = {
								culture = pecheneg
								culture = cuman
							}
						}
						change_culture = nogaybak
					}
				}
				oral_area = {
					limit = { owned_by = ROOT }
					add_core = NOG
					if = {
						limit = {
							OR = {
								culture = pecheneg
								culture = cuman
							}
						}
						change_culture = nogaybak
					}
				}
				#Astrakhan
				lower_volga_region = {
					limit = { owned_by = ROOT }
					add_core = AST
					if = {
						limit = {
							OR = {
								culture = pecheneg
								culture = cuman
							}
						}
						change_culture = astrakhani
					}
				}
				kumykia_area = {
					limit = { owned_by = ROOT }
					add_core = AST
					if = {
						limit = {
							OR = {
								culture = pecheneg
								culture = cuman
							}
						}
						change_culture = astrakhani
					}
				}
				kabardia_area = {
					limit = { owned_by = ROOT }
					add_core = AST
					if = {
						limit = {
							OR = {
								culture = pecheneg
								culture = cuman
							}
						}
						change_culture = astrakhani
					}
				}
			}
			else = {
				#Jalarids
				lower_mesopotamia_region = {
					limit = { owned_by = ROOT }
					add_core = JYA
				}
				dulaim_area = {
					limit = { owned_by = ROOT }
					add_core = JYA
				}
				#Aq Qoyunlu
				sophene_region = {
					limit = { owned_by = ROOT }
					add_core = AKK
				}
				#Qara Qoyunlu
				al_jazira_region = {
					limit = { owned_by = ROOT }
					add_core = QAR
				}
				mosul_area = {
					limit = { owned_by = ROOT }
					add_core = QAR
				}
				zagros_area = {
					limit = { owned_by = ROOT }
					add_core = QAR
				}
				shahrizor_area = {
					limit = { owned_by = ROOT }
					add_core = QAR
				}
				zab_area = {
					limit = { owned_by = ROOT }
					add_core = QAR
				}
			}
		}
	}
	
	option = {
		name = collapse_of_the_khaganate.1.a
		add_stability = -3
		if = {
			limit = { has_country_modifier = invasion_nation_m }
			remove_country_modifier = invasion_nation_m
		}
		random_owned_province = {
			limit = { can_spawn_rebels = nationalist_rebels }
			spawn_rebels = {
				size = 5
				type = nationalist_rebels
			}
		}
		random_owned_province = {
			limit = { can_spawn_rebels = nationalist_rebels }
			spawn_rebels = {
				size = 5
				type = nationalist_rebels
			}
		}
		random_owned_province = {
			limit = { can_spawn_rebels = nationalist_rebels }
			spawn_rebels = {
				size = 5
				type = nationalist_rebels
			}
		}
		random_owned_province = {
			limit = { can_spawn_rebels = nationalist_rebels }
			spawn_rebels = {
				size = 5
				type = nationalist_rebels
			}
		}
		random_owned_province = {
			limit = { can_spawn_rebels = nationalist_rebels }
			spawn_rebels = {
				size = 5
				type = nationalist_rebels
			}
		}
	}
}

#Trade Disputes
country_event = {
	id = collapse_of_the_khaganate.2
	title = collapse_of_the_khaganate.2.t
	desc = collapse_of_the_khaganate.2.d
	picture = {
		trigger = { NOT = { has_dlc = "Star and Crescent" } }
		picture = CIVIL_WAR_eventPicture
	}
	picture = {
		trigger = { has_dlc = "Star and Crescent" }
		picture = muslimgfx_CIVIL_WAR_eventPicture
	}

	is_triggered_only = yes

	trigger = {
		NOT = { has_country_modifier = mongol_trade_disputes }
	}

	option = {
		name = collapse_of_the_khaganate.2.a
		add_mercantilism = -5
		add_disaster_modifier = {
			name = mongol_trade_disputes
			duration = -1
			disaster = collapse_of_the_khaganate
		}
	}
}

#Decline of Warfare
country_event = {
	id = collapse_of_the_khaganate.3
	title = collapse_of_the_khaganate.3.t
	desc = collapse_of_the_khaganate.3.d
	picture = {
		trigger = { NOT = { has_dlc = "Star and Crescent" } }
		picture = WOUNDED_SOLDIERS_eventPicture
	}
	picture = {
		trigger = { has_dlc = "Star and Crescent" }
		picture = muslimgfx_WOUNDED_SOLDIERS_eventPicture
	}

	is_triggered_only = yes

	trigger = {
		NOT = { has_country_modifier = mongol_declining_warfare }
	}

	option = {
		name = collapse_of_the_khaganate.3.a
		add_army_tradition = -25
		add_disaster_modifier = {
			name = mongol_declining_warfare
			duration = -1
			disaster = collapse_of_the_khaganate
		}
	}
}

#Rising Corruption
country_event = {
	id = collapse_of_the_khaganate.4
	title = collapse_of_the_khaganate.4.t
	desc = collapse_of_the_khaganate.4.d
	picture = {
		trigger = { NOT = { has_dlc = "Star and Crescent" } }
		picture = CORRUPTION_eventPicture
	}
	picture = {
		trigger = { has_dlc = "Star and Crescent" }
		picture = muslimgfx_CORRUPTION_eventPicture
	}

	is_triggered_only = yes

	option = {
		name = collapse_of_the_khaganate.4.a
		add_corruption = 0.25
		add_years_of_income = -0.25
	}
	option = {
		name = collapse_of_the_khaganate.4.b
		add_adm_power = -50
	}
}

#Diplomatic Termination
country_event = {
	id = collapse_of_the_khaganate.5
	title = collapse_of_the_khaganate.5.t
	desc = collapse_of_the_khaganate.5.d
	picture = {
		trigger = { NOT = { has_dlc = "Star and Crescent" } }
		picture = BAD_WITH_MONARCH_eventPicture
	}
	picture = {
		trigger = { has_dlc = "Star and Crescent" }
		picture = muslimgfx_BAD_WITH_MONARCH_eventPicture
	}

	is_triggered_only = yes

	option = {
		name = collapse_of_the_khaganate.5.a
		if = {
			limit = {
				any_subject_country = {
					NOT = {
						has_opinion_modifier = {
							who = ROOT
							modifier = opinion_displeased
						}
					}
				}
			}
			random_subject_country = {
				limit = {
					NOT = {
						has_opinion_modifier = {
							who = ROOT
							modifier = opinion_displeased
						}
					}
				}
				add_opinion = {
					who = ROOT
					modifier = opinion_displeased
				}
				add_trust = {
					who = ROOT
					value = -10
				}
			}
		}
		else_if = {
			limit = {
				any_ally = {
					NOT = {
						has_opinion_modifier = {
							who = ROOT
							modifier = opinion_displeased
						}
					}
				}
			}
			random_ally = {
				limit = {
					NOT = {
						has_opinion_modifier = {
							who = ROOT
							modifier = opinion_displeased
						}
					}
				}
				add_opinion = {
					who = ROOT
					modifier = opinion_displeased
				}
				add_trust = {
					who = ROOT
					value = -10
				}
			}
		}
		else = {
			random_neighbor_country = {
				add_opinion = {
					who = ROOT
					modifier = opinion_displeased
				}
				add_trust = {
					who = ROOT
					value = -10
				}
			}
		}
	}
	option = {
		name = collapse_of_the_khaganate.5.b
		add_dip_power = -50
	}
}

#Social Unrest
country_event = {
	id = collapse_of_the_khaganate.6
	title = collapse_of_the_khaganate.6.t
	desc = collapse_of_the_khaganate.6.d
	picture = {
		trigger = { NOT = { has_dlc = "Star and Crescent" } }
		picture = RELIGIOUS_TURMOIL_eventPicture
	}
	picture = {
		trigger = { has_dlc = "Star and Crescent" }
		picture = muslimgfx_RELIGIOUS_TURMOIL_eventPicture
	}

	is_triggered_only = yes

	option = {
		name = collapse_of_the_khaganate.6.a
		random_province = {
			limit = { can_spawn_rebels = nationalist_rebels }
			spawn_rebels = {
				type = nationalist_rebels
				size = 1
			}
		}
	}
	option = {
		name = collapse_of_the_khaganate.6.b
		add_mil_power = -50
	}
}

#Ruler is captured
country_event = {
	id = collapse_of_the_khaganate.7
	title = collapse_of_the_khaganate.7.t
	desc = collapse_of_the_khaganate.7.d
	picture = {
		trigger = { NOT = { has_dlc = "Star and Crescent" } }
		picture = BATTLE_eventPicture
	}
	picture = {
		trigger = { has_dlc = "Star and Crescent" }
		picture = muslimgfx_BATTLE_eventPicture
	}

	is_triggered_only = yes

	trigger = {
		NOT = { has_country_flag = ruler_was_captured_flag }
	}

	immediate = {
		hidden_effect = {
			set_country_flag = ruler_was_captured_flag
		}
	}

	option = {
		name = collapse_of_the_khaganate.7.a
		add_years_of_income = -0.5
		change_adm = -1
		change_dip = -1
		change_mil = -1
	}
	option = {
		name = collapse_of_the_khaganate.7.b
		trigger = { heir_age = 15 }
		add_prestige = -10
		kill_ruler = yes
	}
	option = {
		name = collapse_of_the_khaganate.7.c
		trigger = { NOT = { heir_age = 15 } }
		add_stability = -1
		add_prestige = -25
		define_ruler = { hide_skills = yes }
		if = {
			limit = { has_heir = yes }
			remove_heir = yes
		}
	}
}

country_event = {
	id = collapse_of_the_khaganate.100
	title = collapse_of_the_khaganate.100.t
	desc = collapse_of_the_khaganate.100.d
	picture = {
		trigger = { NOT = { has_dlc = "Star and Crescent" } }
		picture = OVEREXTENSION_eventPicture
	}
	picture = {
		trigger = { has_dlc = "Star and Crescent" }
		picture = muslimgfx_OVEREXTENSION_eventPicture
	}

	is_triggered_only = yes
	major = yes

	option = {
		name = collapse_of_the_khaganate.100.a
		clr_country_flag = ruler_was_captured_flag
		add_stability = 1
		add_horde_unity = 25
		add_legitimacy = 25
		add_republican_tradition = 25
		add_devotion = 25
	}
}